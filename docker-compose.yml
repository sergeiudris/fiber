version: "3.7"

services:

  db:
    image: seeris/fiber.db:dev
    volumes:
      - type: volume
        source:  fiber.db
        target: /opt/datomic-data
        volume:
          nocopy: true
    command: ./bin/transactor ./config/free-transactor.properties

  app:
    image: seeris/fiber.app:dev
    ports:
      - 4500:8080
    command: bash f main
    links:
      - db:db
    deploy:
      resources:
        limits:
          cpus: '4'
          memory: 4096M
  ui:
    image: seeris/fiber.ui:dev
    ports:
      - 4600:9500
    command: bash f main
    deploy:
      resources:
        limits:
          cpus: '4'
          memory: 4096M
volumes:
  fiber.db:
     name: fiber.db
